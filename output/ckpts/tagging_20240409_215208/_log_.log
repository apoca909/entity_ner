2024-04-09 21:52:08,945 - INFO - __log__: taskdir ./output/ckpts/tagging_20240409_215208
2024-04-09 21:52:08,946 - INFO - __log__: Process rank:-1, device:cpu, n_gpu:0, dist training:False, 16-bits:False
2024-04-09 21:52:08,946 - INFO - __log__: Training/evaluation parameters Namespace(adam_epsilon=1e-08, config_name='./raw_disf/bert_tagging.json', dev_file=['./data/msra/val.txt'], device=device(type='cpu'), do_eval=True, do_train=True, evaluate_during_training=True, fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, init_checkpoint=None, input_format='raw', label_file='./raw_disf/msra_ner.json', learning_rate=0.001, local_rank=-1, logging_steps=100, max_grad_norm=1.0, max_seq_length=512, max_steps=-1, n_gpu=0, nline=100, no_cuda=False, note='desc note', num_output_variants=0, num_train_epochs=20, output_dir='./output/ckpts/', overwrite=True, overwrite_outputdir=True, per_gpu_eval_batch_size=32, per_gpu_train_batch_size=8, predict_batch_size=32, save_mode='gold_pred', save_steps=50, seed=42, server_ip='', server_port='', task='tagging', train_file=['./data/msra/train.txt'], usecrf=True, vocab_file='./raw_disf/vocab.txt', warmup_steps=0, weight_decay=0.0)
2024-04-09 21:52:08,947 - INFO - __log__: use crf  True done.
2024-04-09 21:52:08,947 - INFO - __log__: init ckpt is None, cold start.
2024-04-09 21:52:12,593 - INFO - __log__: the number of model params: 103067341
2024-04-09 21:52:12,595 - INFO - __log__: *****running training*****
ngpu = 0
init = None
num epoch 20
batch size per gpu 8
gradient accumulation steps 1
lr 0.001
train_file ['./data/msra/train.txt']
input_format raw
Note desc note

2024-04-09 21:52:12,667 - INFO - __log__: *****running training*****
num examples 100
total train batch size(w. parallel, distributed & accumulation) 8
total optimization steps 240

2024-04-09 21:52:12,677 - INFO - __log__: task preprocess ['./data/msra/train.txt']
2024-04-09 21:52:12,731 - INFO - __log__: all lines:97968
2024-04-09 21:52:12,767 - INFO - __log__: 0 0 examples processed {'tokens': ['[CLS]', '三', '名', '没', '有', '位', '置', '的', '小', '乘', '客', '，', '被', '乘', '警', '安', '排', '在', '了', '自', '己', '的', '位', '置', '休', '息', '一', '夜', '。', '[SEP]'], 'tokens_ids': [101, 676, 1399, 3766, 3300, 855, 5390, 4638, 2207, 733, 2145, 8024, 6158, 733, 6356, 2128, 2961, 1762, 749, 5632, 2346, 4638, 855, 5390, 828, 2622, 671, 1915, 511, 102], 'ner_tags': ['O', 'B-mq', 'E-mq', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'O'], 'ner_tags_ids': [0, 90, 92, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}
2024-04-09 21:53:00,975 - INFO - __log__: ***** Running evaluation *****
2024-04-09 21:53:00,975 - INFO - __log__:   Num examples = 100
2024-04-09 21:53:00,976 - INFO - __log__:   Batch size = 32
2024-04-09 21:53:00,978 - INFO - __log__: task preprocess ['./data/msra/val.txt']
2024-04-09 21:53:00,980 - INFO - __log__: all lines:1239
2024-04-09 21:53:00,980 - INFO - __log__: 0 0 examples processed {'tokens': ['[CLS]', '人', '民', '网', '北', '京', '1', '月', '1', '9', '日', '电', '据', '中', '央', '纪', '委', '监', '察', '部', '网', '站', '消', '息', '，', '云', '南', '省', '农', '业', '科', '学', '院', '党', '委', '副', '书', '记', '、', '院', '长', '王', '常', '明', '涉', '嫌', '严', '重', '违', '纪', '，', '接', '受', '组', '织', '调', '查', '。', '[SEP]'], 'tokens_ids': [101, 782, 3696, 5381, 1266, 776, 122, 3299, 122, 130, 3189, 4510, 2945, 704, 1925, 5279, 1999, 4664, 2175, 6956, 5381, 4991, 3867, 2622, 8024, 756, 1298, 4689, 1093, 689, 4906, 2110, 7368, 1054, 1999, 1199, 741, 6381, 510, 7368, 7270, 4374, 2382, 3209, 3868, 2066, 698, 7028, 6824, 5279, 8024, 2970, 1358, 5299, 5302, 6444, 3389, 511, 102], 'ner_tags': ['O', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'B-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'E-nt', 'o', 'o', 'o', 'o', 'o', 'B-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'E-nt', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'B-nz', 'I-nz', 'I-nz', 'I-nz', 'I-nz', 'E-nz', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'O'], 'ner_tags_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 11, 11, 11, 11, 11, 12, 0, 0, 0, 0, 0, 10, 11, 11, 11, 11, 11, 11, 11, 11, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 94, 95, 95, 95, 95, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0]}
2024-04-09 21:53:17,863 - INFO - __log__: finished predict, timecost 16.89, batches/sec 0.2369 
ckpt:None
2024-04-09 21:53:18,147 - INFO - __log__: 
              precision    recall  f1-score   support

           _     0.0000    0.0000    0.0000       163
          mq     0.0000    0.0000    0.0000         8
         nis     0.0000    0.0000    0.0000         1
         nnt     0.0000    0.0000    0.0000         5
          ns     0.0000    0.0000    0.0000         1
          nt     0.0000    0.0000    0.0000        27
         nto     0.0000    0.0000    0.0000         5
         ntu     0.0000    0.0000    0.0000         2
          nz     0.0000    0.0000    0.0000       122

   micro avg     0.0000    0.0000    0.0000       334
   macro avg     0.0000    0.0000    0.0000       334
weighted avg     0.0000    0.0000    0.0000       334


2024-04-09 21:53:18,147 - INFO - __log__: finished compute_metrics, timecost 17.17 save result to ./output/ckpts/val.txt.pred
2024-04-09 21:53:18,152 - INFO - __log__: epoch 0 val_loss 0.77772 ner_f1 0.0
2024-04-09 21:53:18,154 - INFO - __log__: f1 not updated 0 fuse_f1: 0.0; best: 0 epoch: 0
2024-04-09 21:53:18,155 - INFO - __log__: task preprocess ['./data/msra/train.txt']
2024-04-09 21:53:18,220 - INFO - __log__: all lines:97968
2024-04-09 21:53:18,256 - INFO - __log__: 0 0 examples processed {'tokens': ['[CLS]', '三', '名', '没', '有', '位', '置', '的', '小', '乘', '客', '，', '被', '乘', '警', '安', '排', '在', '了', '自', '己', '的', '位', '置', '休', '息', '一', '夜', '。', '[SEP]'], 'tokens_ids': [101, 676, 1399, 3766, 3300, 855, 5390, 4638, 2207, 733, 2145, 8024, 6158, 733, 6356, 2128, 2961, 1762, 749, 5632, 2346, 4638, 855, 5390, 828, 2622, 671, 1915, 511, 102], 'ner_tags': ['O', 'B-mq', 'E-mq', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'O'], 'ner_tags_ids': [0, 90, 92, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}
2024-04-09 21:54:03,390 - INFO - __log__: ***** Running evaluation *****
2024-04-09 21:54:03,391 - INFO - __log__:   Num examples = 100
2024-04-09 21:54:03,391 - INFO - __log__:   Batch size = 32
2024-04-09 21:54:03,392 - INFO - __log__: task preprocess ['./data/msra/val.txt']
2024-04-09 21:54:03,393 - INFO - __log__: all lines:1239
2024-04-09 21:54:03,394 - INFO - __log__: 0 0 examples processed {'tokens': ['[CLS]', '人', '民', '网', '北', '京', '1', '月', '1', '9', '日', '电', '据', '中', '央', '纪', '委', '监', '察', '部', '网', '站', '消', '息', '，', '云', '南', '省', '农', '业', '科', '学', '院', '党', '委', '副', '书', '记', '、', '院', '长', '王', '常', '明', '涉', '嫌', '严', '重', '违', '纪', '，', '接', '受', '组', '织', '调', '查', '。', '[SEP]'], 'tokens_ids': [101, 782, 3696, 5381, 1266, 776, 122, 3299, 122, 130, 3189, 4510, 2945, 704, 1925, 5279, 1999, 4664, 2175, 6956, 5381, 4991, 3867, 2622, 8024, 756, 1298, 4689, 1093, 689, 4906, 2110, 7368, 1054, 1999, 1199, 741, 6381, 510, 7368, 7270, 4374, 2382, 3209, 3868, 2066, 698, 7028, 6824, 5279, 8024, 2970, 1358, 5299, 5302, 6444, 3389, 511, 102], 'ner_tags': ['O', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'B-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'E-nt', 'o', 'o', 'o', 'o', 'o', 'B-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'E-nt', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'B-nz', 'I-nz', 'I-nz', 'I-nz', 'I-nz', 'E-nz', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'O'], 'ner_tags_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 11, 11, 11, 11, 11, 12, 0, 0, 0, 0, 0, 10, 11, 11, 11, 11, 11, 11, 11, 11, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 94, 95, 95, 95, 95, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0]}
2024-04-09 21:54:20,519 - INFO - __log__: finished predict, timecost 17.13, batches/sec 0.2335 
ckpt:None
2024-04-09 21:54:20,798 - INFO - __log__: 
              precision    recall  f1-score   support

           _     0.0000    0.0000    0.0000       163
          mq     0.0000    0.0000    0.0000         8
         nis     0.0000    0.0000    0.0000         1
         nnt     0.0000    0.0000    0.0000         5
          ns     0.0000    0.0000    0.0000         1
          nt     0.0000    0.0000    0.0000        27
         nto     0.0000    0.0000    0.0000         5
         ntu     0.0000    0.0000    0.0000         2
          nz     0.0000    0.0000    0.0000       122

   micro avg     0.0000    0.0000    0.0000       334
   macro avg     0.0000    0.0000    0.0000       334
weighted avg     0.0000    0.0000    0.0000       334


2024-04-09 21:54:20,798 - INFO - __log__: finished compute_metrics, timecost 17.41 save result to ./output/ckpts/val.txt.pred
2024-04-09 21:54:20,803 - INFO - __log__: epoch 1 val_loss 0.72604 ner_f1 0.0
2024-04-09 21:54:20,803 - INFO - __log__: f1 not updated 1 fuse_f1: 0.0; best: 0 epoch: 0
2024-04-09 21:54:20,804 - INFO - __log__: task preprocess ['./data/msra/train.txt']
2024-04-09 21:54:20,865 - INFO - __log__: all lines:97968
2024-04-09 21:54:20,900 - INFO - __log__: 0 0 examples processed {'tokens': ['[CLS]', '三', '名', '没', '有', '位', '置', '的', '小', '乘', '客', '，', '被', '乘', '警', '安', '排', '在', '了', '自', '己', '的', '位', '置', '休', '息', '一', '夜', '。', '[SEP]'], 'tokens_ids': [101, 676, 1399, 3766, 3300, 855, 5390, 4638, 2207, 733, 2145, 8024, 6158, 733, 6356, 2128, 2961, 1762, 749, 5632, 2346, 4638, 855, 5390, 828, 2622, 671, 1915, 511, 102], 'ner_tags': ['O', 'B-mq', 'E-mq', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'O'], 'ner_tags_ids': [0, 90, 92, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}
2024-04-09 21:55:06,002 - INFO - __log__: ***** Running evaluation *****
2024-04-09 21:55:06,003 - INFO - __log__:   Num examples = 100
2024-04-09 21:55:06,003 - INFO - __log__:   Batch size = 32
2024-04-09 21:55:06,005 - INFO - __log__: task preprocess ['./data/msra/val.txt']
2024-04-09 21:55:06,006 - INFO - __log__: all lines:1239
2024-04-09 21:55:06,007 - INFO - __log__: 0 0 examples processed {'tokens': ['[CLS]', '人', '民', '网', '北', '京', '1', '月', '1', '9', '日', '电', '据', '中', '央', '纪', '委', '监', '察', '部', '网', '站', '消', '息', '，', '云', '南', '省', '农', '业', '科', '学', '院', '党', '委', '副', '书', '记', '、', '院', '长', '王', '常', '明', '涉', '嫌', '严', '重', '违', '纪', '，', '接', '受', '组', '织', '调', '查', '。', '[SEP]'], 'tokens_ids': [101, 782, 3696, 5381, 1266, 776, 122, 3299, 122, 130, 3189, 4510, 2945, 704, 1925, 5279, 1999, 4664, 2175, 6956, 5381, 4991, 3867, 2622, 8024, 756, 1298, 4689, 1093, 689, 4906, 2110, 7368, 1054, 1999, 1199, 741, 6381, 510, 7368, 7270, 4374, 2382, 3209, 3868, 2066, 698, 7028, 6824, 5279, 8024, 2970, 1358, 5299, 5302, 6444, 3389, 511, 102], 'ner_tags': ['O', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'B-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'E-nt', 'o', 'o', 'o', 'o', 'o', 'B-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'E-nt', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'B-nz', 'I-nz', 'I-nz', 'I-nz', 'I-nz', 'E-nz', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'O'], 'ner_tags_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 11, 11, 11, 11, 11, 12, 0, 0, 0, 0, 0, 10, 11, 11, 11, 11, 11, 11, 11, 11, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 94, 95, 95, 95, 95, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0]}
2024-04-09 21:55:22,784 - INFO - __log__: finished predict, timecost 16.78, batches/sec 0.2384 
ckpt:None
2024-04-09 21:55:23,057 - INFO - __log__: 
              precision    recall  f1-score   support

           _     0.0000    0.0000    0.0000       163
          mq     0.0000    0.0000    0.0000         8
         nis     0.0000    0.0000    0.0000         1
         nnt     0.0000    0.0000    0.0000         5
          ns     0.0000    0.0000    0.0000         1
          nt     0.0000    0.0000    0.0000        27
         nto     0.0000    0.0000    0.0000         5
         ntu     0.0000    0.0000    0.0000         2
          nz     0.0000    0.0000    0.0000       122

   micro avg     0.0000    0.0000    0.0000       334
   macro avg     0.0000    0.0000    0.0000       334
weighted avg     0.0000    0.0000    0.0000       334


2024-04-09 21:55:23,057 - INFO - __log__: finished compute_metrics, timecost 17.05 save result to ./output/ckpts/val.txt.pred
2024-04-09 21:55:23,063 - INFO - __log__: epoch 2 val_loss 0.70689 ner_f1 0.0
2024-04-09 21:55:23,063 - INFO - __log__: f1 not updated 2 fuse_f1: 0.0; best: 0 epoch: 0
2024-04-09 21:55:23,065 - INFO - __log__: task preprocess ['./data/msra/train.txt']
2024-04-09 21:55:23,127 - INFO - __log__: all lines:97968
2024-04-09 21:55:23,165 - INFO - __log__: 0 0 examples processed {'tokens': ['[CLS]', '三', '名', '没', '有', '位', '置', '的', '小', '乘', '客', '，', '被', '乘', '警', '安', '排', '在', '了', '自', '己', '的', '位', '置', '休', '息', '一', '夜', '。', '[SEP]'], 'tokens_ids': [101, 676, 1399, 3766, 3300, 855, 5390, 4638, 2207, 733, 2145, 8024, 6158, 733, 6356, 2128, 2961, 1762, 749, 5632, 2346, 4638, 855, 5390, 828, 2622, 671, 1915, 511, 102], 'ner_tags': ['O', 'B-mq', 'E-mq', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'O'], 'ner_tags_ids': [0, 90, 92, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}
2024-04-09 21:56:07,814 - INFO - __log__: ***** Running evaluation *****
2024-04-09 21:56:07,814 - INFO - __log__:   Num examples = 100
2024-04-09 21:56:07,814 - INFO - __log__:   Batch size = 32
2024-04-09 21:56:07,816 - INFO - __log__: task preprocess ['./data/msra/val.txt']
2024-04-09 21:56:07,818 - INFO - __log__: all lines:1239
2024-04-09 21:56:07,818 - INFO - __log__: 0 0 examples processed {'tokens': ['[CLS]', '人', '民', '网', '北', '京', '1', '月', '1', '9', '日', '电', '据', '中', '央', '纪', '委', '监', '察', '部', '网', '站', '消', '息', '，', '云', '南', '省', '农', '业', '科', '学', '院', '党', '委', '副', '书', '记', '、', '院', '长', '王', '常', '明', '涉', '嫌', '严', '重', '违', '纪', '，', '接', '受', '组', '织', '调', '查', '。', '[SEP]'], 'tokens_ids': [101, 782, 3696, 5381, 1266, 776, 122, 3299, 122, 130, 3189, 4510, 2945, 704, 1925, 5279, 1999, 4664, 2175, 6956, 5381, 4991, 3867, 2622, 8024, 756, 1298, 4689, 1093, 689, 4906, 2110, 7368, 1054, 1999, 1199, 741, 6381, 510, 7368, 7270, 4374, 2382, 3209, 3868, 2066, 698, 7028, 6824, 5279, 8024, 2970, 1358, 5299, 5302, 6444, 3389, 511, 102], 'ner_tags': ['O', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'B-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'E-nt', 'o', 'o', 'o', 'o', 'o', 'B-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'E-nt', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'B-nz', 'I-nz', 'I-nz', 'I-nz', 'I-nz', 'E-nz', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'O'], 'ner_tags_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 11, 11, 11, 11, 11, 12, 0, 0, 0, 0, 0, 10, 11, 11, 11, 11, 11, 11, 11, 11, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 94, 95, 95, 95, 95, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0]}
2024-04-09 21:56:26,302 - INFO - __log__: finished predict, timecost 18.49, batches/sec 0.2164 
ckpt:None
2024-04-09 21:56:26,580 - INFO - __log__: 
              precision    recall  f1-score   support

           _     0.0000    0.0000    0.0000       163
          mq     0.0000    0.0000    0.0000         8
         nis     0.0000    0.0000    0.0000         1
         nnt     0.0000    0.0000    0.0000         5
          ns     0.0000    0.0000    0.0000         1
          nt     0.0000    0.0000    0.0000        27
         nto     0.0000    0.0000    0.0000         5
         ntu     0.0000    0.0000    0.0000         2
          nz     0.0000    0.0000    0.0000       122

   micro avg     0.0000    0.0000    0.0000       334
   macro avg     0.0000    0.0000    0.0000       334
weighted avg     0.0000    0.0000    0.0000       334


2024-04-09 21:56:26,580 - INFO - __log__: finished compute_metrics, timecost 18.77 save result to ./output/ckpts/val.txt.pred
2024-04-09 21:56:26,587 - INFO - __log__: epoch 3 val_loss 0.69835 ner_f1 0.0
2024-04-09 21:56:26,587 - INFO - __log__: f1 not updated 3 fuse_f1: 0.0; best: 0 epoch: 0
2024-04-09 21:56:26,588 - INFO - __log__: task preprocess ['./data/msra/train.txt']
2024-04-09 21:56:26,647 - INFO - __log__: all lines:97968
2024-04-09 21:56:26,682 - INFO - __log__: 0 0 examples processed {'tokens': ['[CLS]', '三', '名', '没', '有', '位', '置', '的', '小', '乘', '客', '，', '被', '乘', '警', '安', '排', '在', '了', '自', '己', '的', '位', '置', '休', '息', '一', '夜', '。', '[SEP]'], 'tokens_ids': [101, 676, 1399, 3766, 3300, 855, 5390, 4638, 2207, 733, 2145, 8024, 6158, 733, 6356, 2128, 2961, 1762, 749, 5632, 2346, 4638, 855, 5390, 828, 2622, 671, 1915, 511, 102], 'ner_tags': ['O', 'B-mq', 'E-mq', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'O'], 'ner_tags_ids': [0, 90, 92, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}
2024-04-09 21:57:16,712 - INFO - __log__: ***** Running evaluation *****
2024-04-09 21:57:16,713 - INFO - __log__:   Num examples = 100
2024-04-09 21:57:16,713 - INFO - __log__:   Batch size = 32
2024-04-09 21:57:16,715 - INFO - __log__: task preprocess ['./data/msra/val.txt']
2024-04-09 21:57:16,716 - INFO - __log__: all lines:1239
2024-04-09 21:57:16,716 - INFO - __log__: 0 0 examples processed {'tokens': ['[CLS]', '人', '民', '网', '北', '京', '1', '月', '1', '9', '日', '电', '据', '中', '央', '纪', '委', '监', '察', '部', '网', '站', '消', '息', '，', '云', '南', '省', '农', '业', '科', '学', '院', '党', '委', '副', '书', '记', '、', '院', '长', '王', '常', '明', '涉', '嫌', '严', '重', '违', '纪', '，', '接', '受', '组', '织', '调', '查', '。', '[SEP]'], 'tokens_ids': [101, 782, 3696, 5381, 1266, 776, 122, 3299, 122, 130, 3189, 4510, 2945, 704, 1925, 5279, 1999, 4664, 2175, 6956, 5381, 4991, 3867, 2622, 8024, 756, 1298, 4689, 1093, 689, 4906, 2110, 7368, 1054, 1999, 1199, 741, 6381, 510, 7368, 7270, 4374, 2382, 3209, 3868, 2066, 698, 7028, 6824, 5279, 8024, 2970, 1358, 5299, 5302, 6444, 3389, 511, 102], 'ner_tags': ['O', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'B-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'E-nt', 'o', 'o', 'o', 'o', 'o', 'B-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'E-nt', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'B-nz', 'I-nz', 'I-nz', 'I-nz', 'I-nz', 'E-nz', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'O'], 'ner_tags_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 11, 11, 11, 11, 11, 12, 0, 0, 0, 0, 0, 10, 11, 11, 11, 11, 11, 11, 11, 11, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 94, 95, 95, 95, 95, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0]}
2024-04-09 21:57:34,523 - INFO - __log__: finished predict, timecost 17.81, batches/sec 0.2246 
ckpt:None
2024-04-09 21:57:34,799 - INFO - __log__: 
              precision    recall  f1-score   support

           _     0.0000    0.0000    0.0000       163
          mq     0.0000    0.0000    0.0000         8
         nis     0.0000    0.0000    0.0000         1
         nnt     0.0000    0.0000    0.0000         5
          ns     0.0000    0.0000    0.0000         1
          nt     0.0000    0.0000    0.0000        27
         nto     0.0000    0.0000    0.0000         5
         ntu     0.0000    0.0000    0.0000         2
          nz     0.0000    0.0000    0.0000       122

   micro avg     0.0000    0.0000    0.0000       334
   macro avg     0.0000    0.0000    0.0000       334
weighted avg     0.0000    0.0000    0.0000       334


2024-04-09 21:57:34,799 - INFO - __log__: finished compute_metrics, timecost 18.09 save result to ./output/ckpts/val.txt.pred
2024-04-09 21:57:34,808 - INFO - __log__: epoch 4 val_loss 0.69354 ner_f1 0.0
2024-04-09 21:57:34,808 - INFO - __log__: f1 not updated 4 fuse_f1: 0.0; best: 0 epoch: 0
2024-04-09 21:57:34,810 - INFO - __log__: task preprocess ['./data/msra/train.txt']
2024-04-09 21:57:34,871 - INFO - __log__: all lines:97968
2024-04-09 21:57:34,906 - INFO - __log__: 0 0 examples processed {'tokens': ['[CLS]', '三', '名', '没', '有', '位', '置', '的', '小', '乘', '客', '，', '被', '乘', '警', '安', '排', '在', '了', '自', '己', '的', '位', '置', '休', '息', '一', '夜', '。', '[SEP]'], 'tokens_ids': [101, 676, 1399, 3766, 3300, 855, 5390, 4638, 2207, 733, 2145, 8024, 6158, 733, 6356, 2128, 2961, 1762, 749, 5632, 2346, 4638, 855, 5390, 828, 2622, 671, 1915, 511, 102], 'ner_tags': ['O', 'B-mq', 'E-mq', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'O'], 'ner_tags_ids': [0, 90, 92, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}
2024-04-09 21:58:18,794 - INFO - __log__: ***** Running evaluation *****
2024-04-09 21:58:18,795 - INFO - __log__:   Num examples = 100
2024-04-09 21:58:18,795 - INFO - __log__:   Batch size = 32
2024-04-09 21:58:18,796 - INFO - __log__: task preprocess ['./data/msra/val.txt']
2024-04-09 21:58:18,798 - INFO - __log__: all lines:1239
2024-04-09 21:58:18,798 - INFO - __log__: 0 0 examples processed {'tokens': ['[CLS]', '人', '民', '网', '北', '京', '1', '月', '1', '9', '日', '电', '据', '中', '央', '纪', '委', '监', '察', '部', '网', '站', '消', '息', '，', '云', '南', '省', '农', '业', '科', '学', '院', '党', '委', '副', '书', '记', '、', '院', '长', '王', '常', '明', '涉', '嫌', '严', '重', '违', '纪', '，', '接', '受', '组', '织', '调', '查', '。', '[SEP]'], 'tokens_ids': [101, 782, 3696, 5381, 1266, 776, 122, 3299, 122, 130, 3189, 4510, 2945, 704, 1925, 5279, 1999, 4664, 2175, 6956, 5381, 4991, 3867, 2622, 8024, 756, 1298, 4689, 1093, 689, 4906, 2110, 7368, 1054, 1999, 1199, 741, 6381, 510, 7368, 7270, 4374, 2382, 3209, 3868, 2066, 698, 7028, 6824, 5279, 8024, 2970, 1358, 5299, 5302, 6444, 3389, 511, 102], 'ner_tags': ['O', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'B-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'E-nt', 'o', 'o', 'o', 'o', 'o', 'B-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'I-nt', 'E-nt', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'B-nz', 'I-nz', 'I-nz', 'I-nz', 'I-nz', 'E-nz', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'o', 'O'], 'ner_tags_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 11, 11, 11, 11, 11, 12, 0, 0, 0, 0, 0, 10, 11, 11, 11, 11, 11, 11, 11, 11, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 94, 95, 95, 95, 95, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0]}
